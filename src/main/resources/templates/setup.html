<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="content">
    <div class="page-header">
        <h2>Setup Wizard</h2>
    </div>

    <div class="panel mb-3">
        <div class="panel-header">
            <h3>Prerequisites Check</h3>
        </div>
        <div class="panel-body">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Status</th>
                        <th>Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Claude Code CLI</td>
                        <td>
                            <span class="status" th:classappend="${cliAvailable ? 'status-completed' : 'status-failed'}"
                                  th:text="${cliAvailable ? 'OK' : 'MISSING'}">OK</span>
                        </td>
                        <td th:if="${cliAvailable}">Claude Code CLI is installed and accessible.</td>
                        <td th:unless="${cliAvailable}">
                            Install Claude Code: <code>npm install -g @anthropic-ai/claude-code</code>
                        </td>
                    </tr>
                    <tr>
                        <td>Claude Code Auth</td>
                        <td>
                            <span class="status" th:classappend="${cliAuthenticated ? 'status-completed' : 'status-failed'}"
                                  th:text="${cliAuthenticated ? 'OK' : 'FAILED'}">OK</span>
                        </td>
                        <td th:if="${cliAuthenticated}">Authentication verified.</td>
                        <td th:unless="${cliAuthenticated}">
                            Set <code>ANTHROPIC_API_KEY</code> environment variable.
                        </td>
                    </tr>
                    <tr>
                        <td>GitHub Token</td>
                        <td>
                            <span class="status" th:classappend="${githubTokenSet ? 'status-completed' : 'status-failed'}"
                                  th:text="${githubTokenSet ? 'OK' : 'MISSING'}">OK</span>
                        </td>
                        <td th:if="${githubTokenSet}">GitHub token is configured.</td>
                        <td th:unless="${githubTokenSet}">
                            Set <code>GITHUB_TOKEN</code> environment variable with <code>repo</code> scope.
                        </td>
                    </tr>
                    <tr>
                        <td>Work Directory</td>
                        <td>
                            <span class="status" th:classappend="${workDirOk ? 'status-completed' : 'status-failed'}"
                                  th:text="${workDirOk ? 'OK' : 'ISSUE'}">OK</span>
                        </td>
                        <td th:text="${workDirMessage}">Work directory details</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="panel mb-3">
        <div class="panel-header">
            <h3>Quick Start</h3>
        </div>
        <div class="panel-body">
            <p th:if="${allPassed}" style="color: var(--color-completed); font-weight: 600;">
                All prerequisites are met. You're ready to go!
            </p>
            <p th:unless="${allPassed}" style="color: var(--color-failed); font-weight: 600;">
                Some prerequisites are not met. Please resolve the issues above.
            </p>

            <h4 class="mt-2">Next Steps</h4>
            <ol>
                <li>Go to <a href="/repositories">Repositories</a> and add a GitHub repository to watch.</li>
                <li>On your GitHub repo, add the label <code>agent-ready</code> to an issue you want IssueBot to work on.</li>
                <li>IssueBot will detect the issue and begin implementation automatically.</li>
                <li>Monitor progress on the <a href="/">Dashboard</a>.</li>
            </ol>
        </div>
    </div>

    <div class="panel">
        <div class="panel-header">
            <h3>Configuration File</h3>
        </div>
        <div class="panel-body">
            <p class="text-sm text-muted mb-2">
                IssueBot looks for a config file at <code>~/.issuebot/config.yml</code>.
                Below is an example configuration:
            </p>
            <pre class="diff-viewer">issuebot:
  poll-interval-seconds: 60
  max-concurrent-issues: 3
  work-directory: ${user.home}/.issuebot/repos
  claude-code:
    max-turns-per-invocation: 30
    model: claude-sonnet-4-5-20250929
    timeout-minutes: 10
  github:
    token: ${GITHUB_TOKEN}
  notifications:
    desktop: true
    dashboard: true
  repositories:
    - owner: your-org
      name: your-repo
      branch: main
      mode: autonomous
      max-iterations: 5
      ci-timeout-minutes: 15</pre>
        </div>
    </div>
</div>
</body>
</html>
